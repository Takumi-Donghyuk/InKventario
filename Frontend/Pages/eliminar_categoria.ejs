<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Eliminar categoría</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-gray-100 min-h-screen p-6">
 <!-- Botón de regreso -->
  <div class="w-full max-w-2xl mb-6 text-center">
    <a href="/admin" 
       class="inline-block bg-emerald-500 text-white px-5 py-2 rounded-lg 
       shadow hover:bg-emerald-600 transition">
       ⬅ Volver al panel principal
    </a>
  </div>
<main class="max-w-6xl mx-auto">
<h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Lista de categorías para eliminar</h1>
</main>
<!-- Tabla -->
<div class="bg-white shadow-lg rounded-lg w-full">
  <table class="table-auto w-full divide-y divide-gray-200">
    <thead class="bg-emerald-500 text-white">
      <tr>
        <th class="px-6 py-3 text-center text-sm font-medium uppercase tracking-wider">Nombre</th>
        <th class="px-6 py-3 text-center text-sm font-medium uppercase tracking-wider">Descripción</th>
        <th class="px-6 py-3 text-center text-sm font-medium uppercase tracking-wider">Acción</th>
      </tr>
    </thead>
    <tbody class="bg-white divide-y divide-gray-200">
      <% categorias.forEach(c => { %>
        <tr class="hover:bg-gray-100 transition">
          <td class="px-6 py-4 text-gray-700 font-medium text-center break-words"><%= c.nombre %></td>
          <td class="px-6 py-4 text-gray-700 text-center break-words"><%= c.descripcion %></td>
          <td class="px-6 py-4 text-center">
            <button onclick="eliminarCategoria(<%= c.id_categoria %>)"
            class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded 
            font-semibold transition">
            Eliminar
            </button>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>


</body>

<script>
async function eliminarCategoria(id) {
  const resultado = await Swal.fire({
    title: '¿Estás seguro?',
    text: "¡No podrás revertir esto!",
    icon: 'warning',
    showCancelButton: true,
    confirmButtonColor: '#d33',
    cancelButtonColor: '#3085d6',
    confirmButtonText: 'Sí, eliminar',
    cancelButtonText: 'Cancelar'
  });

  if (!resultado.isConfirmed) return; 
  try {
    const res = await fetch(`/categorias/eliminar/${id}`, {
      method: 'DELETE'
    });

    if (res.ok) {
      await Swal.fire({
        icon: 'success',
        title: '¡Eliminado!',
        text: 'Categoría eliminada correctamente',
        timer: 1500,
        showConfirmButton: false
      });
      window.location.href = '/admin';
    } else {
      const msg = await res.text();
      Swal.fire({
        icon: 'error',
        title: 'Error',
        text: msg
      });
    }
  } catch (err) {
    console.error(err);
    Swal.fire({
      icon: 'error',
      title: 'Error',
      text: 'Error al eliminar la categoría'
    });
  }
}
</script>

</html>